import{d as V,b1 as _,i as L,ae as S,r as w,b2 as H,ab as c,b3 as M,ac as z,j as I,ap as q,k as A,l as F,a0 as N}from"./index.2205830d.js";function O(l){return Math.floor(Math.abs(l))*Math.sign(l)}const Y=V({name:"VParallax",props:{scale:{type:[Number,String],default:.5}},setup(l,h){let{slots:g}=h;const{intersectionRef:o,isIntersecting:s}=_(),{resizeRef:b,contentRect:i}=L(),{height:x}=S(),n=w();H(()=>{var e;o.value=b.value=(e=n.value)==null?void 0:e.$el});let t;c(s,e=>{e?(t=M(o.value),t=t===document.scrollingElement?document:t,t.addEventListener("scroll",a,{passive:!0}),a()):t.removeEventListener("scroll",a)}),z(()=>{var e;(e=t)==null||e.removeEventListener("scroll",a)}),c(x,a),c(()=>{var e;return(e=i.value)==null?void 0:e.height},a);const u=I(()=>1-q(+l.scale));let v=-1;function a(){!s.value||(cancelAnimationFrame(v),v=requestAnimationFrame(()=>{var d,p;var e;const m=((e=n.value)==null?void 0:e.$el).querySelector(".v-img__img");if(!m)return;const f=(d=t.clientHeight)!=null?d:document.documentElement.clientHeight,P=(p=t.scrollTop)!=null?p:window.scrollY,$=o.value.offsetTop,r=i.value.height,y=$+(r-f)/2,E=O((P-y)*u.value),R=Math.max(1,(u.value*(f-r)+r)/r);m.style.setProperty("transform",`translateY(${E}px) scale(${R})`)}))}return A(()=>F(N,{class:["v-parallax",{"v-parallax--active":s.value}],ref:n,cover:!0,onLoadstart:a,onLoad:a},g)),{}}});export{Y as V};
